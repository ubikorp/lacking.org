---
import type { ImageMetadata } from 'astro';
import { Icon } from 'astro-icon/components';
import Image from '~/tlo/ui/Image.astro';
import PostTags from '~/tlo/ui/Tags.astro';

import { APP_BLOG } from '~/utils/config';
import type { Post } from '~/types';

import Heading from '~/tlo/ui/Heading.astro';
import Player from '~/tlo/widgets/Player.astro';

import { getPermalink } from '~/utils/permalinks';
import { findImage } from '~/utils/images';
import { getFormattedDate } from '~/utils/utils';

// TLO
import { toMarkdown } from '~/utils/tlo';
import FeatureImage from './FeatureImage.astro';

export interface Props {
  post: Post;
  variant?: 'full' | 'short' | 'micro'
}

const {
  post,
  variant = 'full'
} = Astro.props;

const full = variant == 'full'
// const short = variant == 'short'
const micro = variant == 'micro'
---

<article class="tlo-item">

  <!-- Feature Image (All) -->
  <FeatureImage post={post} caption={false} />

  <!-- Heading (All) -->
  <Heading post={post} short={true} />

  <!-- Excerpt (Full / Short) -->
  {!micro && post.excerpt && <p set:html={toMarkdown(post.excerpt)} />}

  <!-- Media (Full) -->
  {full &&
    <div class="my-4">
      {post.media && <Player media={post.media} />}
    </div>
  }

  <!-- Tags (Full) -->
  {full &&
    <footer class="mt-4">
      <PostTags tags={post.tags} />
    </footer>
  }

  </article>
